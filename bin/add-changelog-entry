#!/bin/sh

# add new entry to changelog

# versioning defined by date + increment for disambiguation
VER_DATE="`date +%Y.%m.%d`"
# get entry total for "today" 
VER_CHECK=`grep $VER_DATE CHANGELOG.md | wc -l`
# increment it (if 0 then 1, if one then next is 2, etc.)
VER_COUNT=$(($VER_CHECK + 1))
# full version
THIS_VERSION="$VER_DATE.$VER_COUNT"

# look at changes
git diff | less

# add placeholder hint line
echo '  - add changes here (markdown w/ bullets works well...)' >> temp-cl.txt
# open in vi
vi temp-cl.txt
# sed version to top
sed -i '1i`'"${THIS_VERSION}"'`' temp-cl.txt
# add newline to keep md formatting correctly
echo "\n" >> temp-cl.txt
# sed new entry into README append to top of changelog section
sed -i '/###### changelog/r temp-cl.txt' CHANGELOG.md
# remove temp file
rm temp-cl.txt
